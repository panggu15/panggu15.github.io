---
layout: single
title:  "DCGan으로 숫자 그리기"
categories: gan
tag: [tensorflow, pytorch]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


# DCGan 구현



데이터셋 : MNIST


# 텐서플로



```python
import numpy as np
import matplotlib.pyplot as plt
from tqdm import tqdm

import tensorflow as tf
from tensorflow.keras.layers import Input, Conv2D, Dense, BatchNormalization, Flatten, Reshape, Conv2DTranspose, LeakyReLU, Dropout
from tensorflow.keras import Model
```

## 데이터셋 준비



```python
(train, label), (_, _) = tf.keras.datasets.mnist.load_data()
```

<pre>
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 [==============================] - 0s 0us/step
11501568/11490434 [==============================] - 0s 0us/step
</pre>

```python
for i in range(5):
  plt.subplot(1,5,i+1)
  plt.imshow(train[i])
```

<img src="data:image/png;base64,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"/>


```python
train = train.reshape(train.shape[0], 28, 28, 1)
train = (train - 127.5) / 127.5
```


```python
buffer_size = 6000
batch_size = 64
```


```python
dataset = tf.data.Dataset.from_tensor_slices(train).shuffle(buffer_size).batch(batch_size)
```

## 모델 생성



```python
g_input = Input(shape=(100,))

x = Dense(7*7*256)(g_input)
x = BatchNormalization()(x)
x = LeakyReLU()(x)

x = Reshape((7,7,256))(x)
x = Conv2DTranspose(128, 5, 1, padding='same')(x)
x = BatchNormalization()(x)
x = LeakyReLU()(x)

x = Conv2DTranspose(64, 5, 2, padding='same')(x)
x = BatchNormalization()(x)
x = LeakyReLU()(x)

x = Conv2DTranspose(1, 5, 2, padding='same', activation='tanh')(x)

generator = Model(g_input, x)
```


```python
noise = tf.random.normal([1, 100])
sample = generator(noise)
plt.imshow(sample[0, :, :, 0])
```

<pre>
<matplotlib.image.AxesImage at 0x7f6330460f90>
</pre>
<img src="data:image/png;base64,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"/>


```python
d_input = Input((28,28,1))

x = Conv2D(64, 5, 2, padding='same')(d_input)
x = LeakyReLU()(x)

x = Conv2D(128, 5, 2, padding='same')(x)
x = LeakyReLU()(x)

x = Flatten()(x)
x = Dropout(0.4)(x)
x = Dense(1, activation='sigmoid')(x)

discriminator = Model(d_input, x)
```


```python
dec = discriminator(sample)
dec
```

<pre>
<tf.Tensor: shape=(1, 1), dtype=float32, numpy=array([[0.4998645]], dtype=float32)>
</pre>

```python
loss_fn = tf.keras.losses.BinaryCrossentropy(from_logits=True)
```


```python
def dis_loss(real, fake):
  real_loss = loss_fn(tf.ones_like(real), real)
  fake_loss = loss_fn(tf.zeros_like(fake), fake)
  return real_loss + fake_loss

def gen_loss(fake):
  return loss_fn(tf.ones_like(fake), fake)
```


```python
g_opt = tf.keras.optimizers.Adam(1e-4)
d_opt = tf.keras.optimizers.Adam(1e-4)
```


```python
epochs = 50
z_dim = 100
```


```python
@tf.function
def train_step(images):
  noise = tf.random.normal([batch_size, z_dim])

  with tf.GradientTape() as gen_tape, tf.GradientTape() as dis_tape:
    gen_imgs = generator(noise, training=True)

    real = discriminator(images, training=True)
    fake = discriminator(gen_imgs, training=True)

    g_loss = gen_loss(fake)
    d_loss = dis_loss(real, fake)

  g_gradient = gen_tape.gradient(g_loss, generator.trainable_variables)
  d_gradient = dis_tape.gradient(d_loss, discriminator.trainable_variables)

  g_opt.apply_gradients(zip(g_gradient, generator.trainable_variables))
  d_opt.apply_gradients(zip(d_gradient, discriminator.trainable_variables))

  return g_loss, d_loss
```


```python
def train(dataset, epochs):
  for epoch in tqdm(range(epochs)):

    for images in dataset:
      g_loss, d_loss = train_step(images)

    print('g_loss: {}, d_loss: {}'.format(g_loss, d_loss))
    generate_images(generator)

def generate_images(gen):
  noises = tf.random.normal([10, z_dim])
  imgs = gen(noises)
  for i in range(len(imgs)):
    plt.subplot(1,10,i+1)
    plt.imshow(imgs[i,:,:,0])
  plt.show()
```


```python
train(dataset, 30)
```


```python
noises = tf.random.normal([10, z_dim])
imgs = generator(noises)
plt.figure(figsize=(20,16))
for i in range(len(imgs)):
  plt.subplot(1,10,i+1)
  plt.imshow(imgs[i,:,:,0])
plt.show()
```

<img src="data:image/png;base64,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"/>

# 파이토치



```python
import torch
import torch.nn as nn
import torchvision.datasets as dsets
import torchvision.transforms as transforms

import matplotlib.pyplot as plt
from tqdm import tqdm
```

## 데이터셋 준비



```python
device = 'cuda' if torch.cuda.is_available() else 'cpu'

transform = transforms.Compose([transforms.ToTensor(), transforms.Normalize(mean=[0.5], std=[0.5])])
mnist_train = dsets.MNIST(root='data/',
                         train=True, # 트레인 셋
                         transform=transform,
                         download=True)
```

<pre>
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to data/MNIST/raw/train-images-idx3-ubyte.gz
</pre>
<pre>
  0%|          | 0/9912422 [00:00<?, ?it/s]
</pre>
<pre>
Extracting data/MNIST/raw/train-images-idx3-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to data/MNIST/raw/train-labels-idx1-ubyte.gz
</pre>
<pre>
  0%|          | 0/28881 [00:00<?, ?it/s]
</pre>
<pre>
Extracting data/MNIST/raw/train-labels-idx1-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to data/MNIST/raw/t10k-images-idx3-ubyte.gz
</pre>
<pre>
  0%|          | 0/1648877 [00:00<?, ?it/s]
</pre>
<pre>
Extracting data/MNIST/raw/t10k-images-idx3-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to data/MNIST/raw/t10k-labels-idx1-ubyte.gz
</pre>
<pre>
  0%|          | 0/4542 [00:00<?, ?it/s]
</pre>
<pre>
Extracting data/MNIST/raw/t10k-labels-idx1-ubyte.gz to data/MNIST/raw

</pre>

```python
# 랜덤으로 9개만 시각화
figure = plt.figure(figsize=(8, 8))
cols, rows = 3, 3
for i in range(1, cols * rows + 1):
    sample_idx = torch.randint(len(mnist_train), size=(1,)).item()
    img, label = mnist_train[sample_idx]
    figure.add_subplot(rows, cols, i)
    plt.axis("off") # x축, y축 안보이게 설정
    plt.imshow(img.squeeze(), cmap="gray")
plt.show() 
```

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAckAAAHBCAYAAAACbEAcAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAcd0lEQVR4nO3de7BVZd0H8LUR8UIKJkreEhUy0XFKLUxUBAfD0lFRxMErMWOAN0bNKUMFywgvYWpmeUlRxxkV75WYCpimpVmMgiKaQjp4OSEgh1Tk7Pcf33fetZ71nL3Z7H322Wd/Pv/9fudZaz3Vgi+r5zlrFYrFYgIAhLrVewIA0FkJSQCIEJIAECEkASBCSAJAhJAEgIju7f2wUCj4/ZAmViwWC/W4rvuuudXjvnPPNbf27jlPkgAQISQBIEJIAkCEkASACCEJABFCEgAihCQARAhJAIho92UCQOPo1i39b96NN944GDNx4sRUveOOOwZjzjvvvOpODBqYJ0kAiBCSABAhJAEgQkgCQISNO9CAuncP/+iOGjUqVd95550lz3PTTTdVbU7QFXmSBIAIIQkAEUISACKsSUID6NGjR6qeMWNGMGbChAklz7NixYpUPXv27A2bGHRxniQBIEJIAkCEkASACCEJABFdcuNO//79U/VRRx0VjLn88ssrOve4ceNS9aOPPhqMeffddys6NyRJeP8mSZL84he/SNVHHHFEyfN8/PHHQW+fffZJ1W+99db6TY5OpV+/fqn69ttvD8b84Q9/SNXTpk2r5ZS6HE+SABAhJAEgQkgCQETDr0n26dMn6D300EOpesCAAcGYtra2iq538803p+rHH388GDN69OhUnf0F7iQJ593S0lLRfGhsm2yySdA755xzgl45a5Bz5sxJ1T/96U+DMdYgu5Yf/vCHqXrw4MHBmNWrV6fqjl6T3H333VP1xIkTgzF59+oHH3xQszmtD0+SABAhJAEgQkgCQISQBICIhtu4k/3l2VmzZgVjsgvFlW7SKcewYcOC3tlnn52qV61aFYw5+eSTU/VPfvKTYMwDDzywgbOjs5syZUrQO+OMM0oe9+STTwa9448/PlUvX7684nnRGLbeeuuSY7bccstU3b17+Nf+Z599VrU5Zf3+979P1bvttlswJu8lCDbuAEAnJyQBIEJIAkCEkASAiIbbuHP33Xen6r333rvkMXlfQ7jwwgtT9YEHHhiMyVsUHzp0aMnrZTfufOELXwjGbLTRRql65syZwZjhw4cHvb/+9a8lr0/nsOmmmwa9gw46KFWfeuqpZZ3rzTffTNXnnntuMMZGna4tb8PNFltsUfK47N+RPXv2DMasXLmy8omV8J///CdV77rrrsGYww8/POi98MILNZvT+vAkCQARQhIAIoQkAEQ03JpkOb88m/Xee+8FvWuvvbbdOmbdunUlx/Tq1avkmOzXRJ599tlgjC82NLbs+mOSJMns2bNLHrdgwYKgl10L99WY5nPAAQcEvcMOO6zkcdkvFdVy/XHEiBFBb7/99it5XN6+kc7CkyQARAhJAIgQkgAQISQBIKLhNu5069at3TqvVygUKrpW3gsG8q5Xyrvvvhv0sm+9f+aZZ9b7vHQugwYNStW33XZbyWMWLVoU9H72s58FPRt1mk/275pRo0ZVdJ4zzzyzGtMpy/e+972gl/37N+9eLufPSr14kgSACCEJABFCEgAiGm5Nsq2trd06T7FYLDnma1/7WtC76667Krr+ihUrUvVJJ50UjLEG2djyXl5+6aWXpuovfelLwZjVq1en6rFjxwZjnnvuuQ2cHV1B9kXgZ5xxRslj8v5eWbZsWdXmlJV96fq3vvWtksfkrT++//77VZtTtXmSBIAIIQkAEUISACKEJABENNzGnUr07t076F1yySWpeueddw7G5G28KEf2iyJz5syp6Dx0Hptsskmqvvrqq4Mxw4cPT9Wtra3BmO9///upuqM36QwePDhVf/jhh8GYhQsXdtR0aMf222+/3sfcd999Qa+czY2V+uUvf5mqd9hhh5LH3HvvvbWaTk14kgSACCEJABFCEgAiGm5N8vTTT0/VP/rRj4Ix2a+49+rVKxgzefLkqswn74vab731VlXOTeeRfXl59j7M86c//Sno5b2gohLZtcUkSZL9998/VR933HHBmOxLM1atWhWMufvuu4Peeeedl6o//fTTsuZJ5Q455JCSY9atW5eqX3311RrNJkl69uwZ9I444oiSx1111VWp+vnnn6/anDqCJ0kAiBCSABAhJAEgQkgCQETDbdx54okn2q2TJFzMrqW8r8jPnDmzw65Pxxg9enTJMY899liqHjduXEXXOvHEE4NeduPMgAEDgjF5GytK2WabbYJe3tcmsi/fWL58+Xpfi/Uzf/78kmM22mijVJ236erll19O1ZW+3GTEiBFBb6eddip5XPblFLV8uUEteJIEgAghCQARQhIAIoQkAEQ03MadcmQ3znz7298OxvTt27eic3frlv53xV/+8peKzkPnlfc2mxNOOKHkcXfeeWeqLhaLJc+Td95DDz006GU35fz6178Oxlx//fWp+qCDDgrGrFy5MlVPmjQpGPONb3wj6A0cODBVP/3008EYqiu7cSfvLUc9evRI1Xmbt7Jvi8rW1fSPf/wj6D388MM1u15H8CQJABFCEgAihCQARHTJNcmxY8em6rw1yUceeaQq17rwwguDXnYtYcWKFVW5Fh0j7+sZW221Vcnjttxyy1Q9YcKEYMxll11W0ZxuuOGGVJ19uUCShF+kWbBgQcnz5q1h5a1Jjhw5MlVbk6y97NeEDj744GDMaaedlqrLeelFubL3c/bFBXl+/vOfB72WlpaqzakePEkCQISQBIAIIQkAEUISACK65MadrEWLFtXs3MOGDQt6Z599dqq+9NJLa3Z9Oo/sppzsxoc8t9xyS9DLu1/ef//9VJ3dpFOu/v37p+oDDzywrOP++c9/VnQ9qudvf/tbyd7EiROrdr2XXnopVe+5557BmM8++yxV//nPf67a9TsLT5IAECEkASBCSAJARFOsSXa0L3/5y6l60003DcZUuqZE55Vdg1y+fHkw5thjj03Vzz33XDDmk08+qej6xx9/fKoeMmRIMGbMmDGpulevXsGY7JfskyRJZs2aVdGc6NqmT5+eqt999906zaR2PEkCQISQBIAIIQkAEUISACIKeV9P/78fFgrxHzaQfv36Bb3FixdXdK5u3dL/rmhrayt5TPYXuJMkSZYsWVLR9TtSsVgs1OO69b7vdtxxx6C3dOnS9T7PunXrgt6qVatKHnfHHXcEvewXILKbw5Kksq82nHXWWUHv1ltvDXqtra0lz1Ut9bjv6n3P1dt+++0X9B577LFU3bt372DM4Ycfnqpnz55d3Yl1kPbuOU+SABAhJAEgQkgCQETTvkwgu7ZYy+PyXiLdCGuSzeqdd94JeuPGjUvVN998c8nz5K0JbrXVViWPy1snLEd2LXHu3LnBmPvuuy9Vr1mzJhhTzjo7XUv25fxJEq5B5q1Lv/rqqzWbU2fhSRIAIoQkAEQISQCIEJIAENG0G3eqtTmhnPOMHTs26N15551VuT7Vl/eCjXvvvTdV77LLLiXPs8022wS98ePHp+q77rorGPPkk08GvZkzZ5a83tq1a1N1ey8KoXnttddeQW/QoEElj8v+GUiS5tiA6EkSACKEJABECEkAiBCSABDRFBt3VqxYEfTmzZuXqocMGdJR06EBffTRR6n64osvrug8EyZMqMZ0oGJ5X0XKfkEmz4IFC2owm87PkyQARAhJAIgQkgAQ0bRrkscdd1yqnj9/fjBm++23r8r1X3nllaqcB2BDtbS0BL28F08UCoVUfcoppwRjrrzyyupNrJPyJAkAEUISACKEJABECEkAiCi096WAQqHQNJ8R+PGPfxz0pkyZEvS6dUv/uyLvKyAPPvhgqj7ttNOCMatXr16/CdZBsVgslB5Vfc103xGqx33X7Pfc3Llzg97BBx+cqkePHh2Mueeee2o1pQ7V3j3nSRIAIoQkAEQISQCIsCZJlDVJ6sGaJB3NmiQAVEBIAkCEkASACCEJABFCEgAihCQARAhJAIgQkgAQISQBIEJIAkCEkASACCEJABFCEgAi2v0KCAA0M0+SABAhJAEgQkgCQISQBIAIIQkAEUISACKEJABECEkAiBCSABAhJAEgQkgCQISQBIAIIQkAEUISACKEJABECEkAiBCSABAhJAEgQkgCQISQBIAIIQkAEUISACKEJABECEkAiOje3g8LhUKxoyZC51MsFgv1uK77rrnV475zzzW39u45T5IAECEkASBCSAJAhJAEgAghCQARQhIAIoQkAEQISQCIEJIAECEkASBCSAJAhJAEgAghCQAR7X4FpJlMnz496F1wwQVBb9iwYal6zpw5NZsTAPXlSRIAIoQkAEQISQCIaNo1ySOPPDJVn3/++cGYYtHHygGamSdJAIgQkgAQISQBIEJIAkBE027cGTx4cKouFArBmLfffjvo/fvf/67ZnKCa8l50ccghh6TqqVOnBmPmzp1bVg+agSdJAIgQkgAQISQBIKJp1yS/853vlByzePHioPf666/XYjrQruxaYrZOkiS55JJL1vu8eccMGTKk5HHWKGkWniQBIEJIAkCEkASACCEJABFNsXEn+8WPJEmSr371qyWPu/zyy2sxHZrYlClTSo7J2xST92KAUvJeFJCVt0knb1PQvHnzUrWNO5XLe3HJmWeeWfK4Pn36BL099tij5LlHjhyZqj/44INgzGWXXVZynuV8Fempp54KevPnzy95XGfmSRIAIoQkAEQISQCIEJIAENEUG3f233//oNe9e+n/6B999FEtpkMXld3wUslmmyQp7805eRtnhg4dWtH1qJ68jVC//e1vU/WsWbOCMRdccEFVrp+3cSe74SZvA9CMGTNKnqucjTstLS1Bb+zYsak6uwksSZJkzZo1Jc9dL54kASBCSAJAhJAEgIimWJM89thj6z0Fupi8X7gvZw0yu5ZYzi/8l3MeOofNN9886O22226pulrrj51R3nrnI488kqq/8pWvBGPeeOONms1pQ3mSBIAIIQkAEUISACKEJABENMXGnXI888wzQa/St9dfc801qTpvk8dtt92Wqq+66qqKrkV9+IV/8ixcuDDoTZo0qQ4zqb7dd9896E2YMGG9z3PccccFvenTp1c0p47gSRIAIoQkAEQISQCIsCb5ubyXmbe2tga9rbbaKlVff/31wZgRI0ak6l69egVjsl8CX7x4cTDmoYceyp8sHS67rpy3zpxl/bH5LFmyJOhdd911dZhJx3j77bdTdfbvtTwHHnhg0LMmCQANSEgCQISQBIAIIQkAETbufO7GG28MetlNOkmSJCeffHKqHj16dEXX69GjR6reeuutKzoPHaOclwdAs5k1a1aqLmfjTqPxJAkAEUISACKEJABEdMk1yW233TZVb7bZZiWPWbp0adDLvqg8SZLkxBNPTNWrV68OxsyYMSNVT5w4MRhjDbKxlPPygKlTp9Z+ItCJjB8/fr2P+c1vflODmdSOJ0kAiBCSABAhJAEgQkgCQESX3LgzduzYVL3TTjuVPOaoo44Ket/97neDXnajzhlnnBGMeeaZZ1L16aefXvL6NL4pU6bUewpQMwMHDgx6xxxzzHqf55VXXqnGdDqMJ0kAiBCSABAhJAEgQkgCQESX3LhTyVsgJk+eXNa47Kac22+/PRhz2GGHpeq+ffuu93zo3Lxdh2az8847B71+/fqVPK5bt8Z+Fmvs2QNADQlJAIgQkgAQ0fBrkkOHDg16ffr0qcq5W1tbg94tt9xS8ri8FwxkrV27NlWvWLGi/IlRU+V88WPIkCElj5s7d251JgSdQN7LBIrFYsnj3nzzzVS9Zs2aqs2pI3iSBIAIIQkAEUISACKEJABENPzGnV133TXo9ezZsyrnzn7xI0mS5LXXXkvV++67bzBmn332SdXZTTpJkiSXXXZZqr7//vsrmSI1UM6Gm7zNPeVs+Kn0+vPmzSt5nK+QUE29e/dO1eVsSMzzu9/9LlUvW7as4jnVgydJAIgQkgAQISQBIKLQ3i+DFgqF0r8pWmfjxo0LejfeeGNVzv3JJ58EvbvuuitVDx8+PBizww47pOrnn38+GDNo0KANnF3tFYvFQj2u2xnvu+x6Y976Y/YFA9VaoyxXdi0z7yXsjfCCg3rcd53xnqu3s846K1XPmDGjovN07975t760d895kgSACCEJABFCEgAihCQARHT+FdU6amlpCXrZjTrZTTpJkiSLFy9O1WPGjKnuxOhw2Q0vHb0BZs6cOam6nJcZ5L2AoBE27tA5XHPNNam6ra2t5DHnnHNOraZTN54kASBCSAJAhJAEgIiGX5PMe3l49gUJhUJlv5uct95Yjh/84Aep+o033qjoPPC/hg4dmqrL+SI8lGvgwIFBL7sGmXfPtba2puolS5ZUd2KdgCdJAIgQkgAQISQBIEJIAkBEw2/cmTlzZtC76KKLUvVuu+1W0bnzFqqzG4Vuu+22YMzChQsruh7ETJkypUOOoevr0aNH0LvgggsqOtcll1ySqh9++OGKztOZeZIEgAghCQARQhIAIoQkAEQ0/MadPMccc0yqzn5BIUmSZOutty55nsmTJwe9adOmVT4xKEPehpvsBok82bfyQJ5zzz036J100kklj8vbkHj//fdXZU6dmSdJAIgQkgAQISQBIKJLrkm+/PLLqXqbbbap00wgLfuCirlz5wZjDjnkkIrOnXcuyDr44IODXt6Xkrp1Sz9D5X3hoyt+9SPLkyQARAhJAIgQkgAQISQBIKJLbtyBziq7uabcTTpTp05N1b7wQbmyGxfzXqSS98Wjtra2VP3Tn/60uhNrEJ4kASBCSAJAhJAEgAhrktCBvIScjrbffvul6n333bes4x566KFU/dJLL1VtTo3EkyQARAhJAIgQkgAQISQBIMLGHQAC2S98rFmzpk4zqS9PkgAQISQBIEJIAkBEIe/Ftv/3w0Ih/kO6vGKxGH6uvAO475pbPe4791xza++e8yQJABFCEgAihCQARAhJAIhod+MOADQzT5IAECEkASBCSAJAhJAEgAghCQARQhIAIoQkAEQISQCIEJIAECEkASBCSAJAhJAEgAghCQARQhIAIoQkAEQISQCIEJIAECEkASBCSAJAhJAEgAghCQARQhIAIoQkAEQISQCIEJIAENG9vR8WCoViR02EzqdYLBbqcV33XXOrx33nnmtu7d1zniQBIEJIAkCEkASACCEJABFCEgAihCQARAhJAIgQkgAQISQBIEJIAkCEkASACCEJABFCEgAihCQARAhJAIgQkgAQISQBIKJ7vSfQWfTr1y/o3X333SWPGzVqVNBbsmRJNaYE0CE222yzoHf++een6vPOOy8YM2zYsFT94osvVndinYAnSQCIEJIAECEkASBCSAJAhI07nzvyyCOD3te//vWg161b+t8Vt9xySzBm9OjRqbqlpWUDZ0dX1bt376D36KOPBr1Bgwal6j/+8Y/BmNbW1lQ9f/78YMzrr7+eqh988MFgzH//+9/8ydJl7b333kFv6tSpJY8bMGBAqrZxBwCaiJAEgAghCQAR1iQ30FNPPRX0Vq5cWYeZ0IiOPvrooPfNb34z6BWLxVQ9YsSIkuc+9thjS455//33g951110X9KZNm5aq161bV/Lc0BV4kgSACCEJABFCEgAihCQARNi4s4EGDhwY9DbffPNUbSMPMXPnzg16q1atCnpbbrllTa6/7bbbBr1LL7006F155ZWp2sadruWLX/xivafQaXmSBIAIIQkAEUISACKEJABE2LizgUaOHBn0LrzwwlRt4w7/a6ONNkrVN910UzCm0k06n376aaru0aNHRedZunRp0LNRp2sbM2ZMyTErVqwIenPmzKnFdDoVT5IAECEkASBCSAJARNOuSfbv3z9VX3311WUd161b+t8VCxcuDMasWbOm8onRpY0fPz5VDxs2LBjzzjvvBL0nnngiVd9+++3BmPfeey9V9+3bt5IpJi0tLUFv7dq1FZ2LzqdQKAS97t1LR8Gzzz4b9PK+ItPVeJIEgAghCQARQhIAIoQkAEQ07cadrLa2toqOu+GGG4LesmXLNnQ6dFEnnHBCyTG33npr0LvooovW+1ovv/zyeh9D1zdgwICgN3r06JLHPffcc7WYTqfnSRIAIoQkAEQISQCIsCYJHeiaa65J1YMHDw7GTJo0KejdcccdqXrRokXVnRhNo5x18TyvvfZalWfSGDxJAkCEkASACCEJABFCEgAibNyBDjR//vySY3r27Bn0Ro4cmaqnTZtWtTnRXGbOnBn0pkyZUvK42bNn12A2nZ8nSQCIEJIAECEkASDCmiR0oOXLl6fqvC+7b7vtth01HZrQKaecUu8pNBRPkgAQISQBIEJIAkCEkASACBt3PtetW3n/XsiOKxQKtZgOXVRLS0uqnjNnTjAm7yvxW2yxRc3mRHMZNWpUWePefPPNVP3pp5/WYjqdnidJAIgQkgAQISQBIEJIAkCEjTufa2trq+i4YrFY5ZnQTF555ZWyxp166qmp+oorrgjGfPjhh1WZE13LXnvtlar79etX1nGPP/54ql6zZk21ptRQPEkCQISQBIAIIQkAEdYk11Nra2uqXrlyZZ1mQjXsu+++Qe+AAw4Ietdee21Nrv/SSy+VNW677bZL1bvsskswxpokebJrkj179izruJtvvrkW02k4niQBIEJIAkCEkASACCEJABE27qynefPmpeo77rijTjOhEtmvuEycODEYM3z48KBXq407ixYtqui4Qw89NOi9+OKLGzoduqC8r8pQPk+SABAhJAEgQkgCQIQ1SZrKJptskqrHjh0bjPn444+DXv/+/VP166+/XpX5LF68uKzegAEDUvX2229flevT9fXp06fkmBdeeCHo/f3vf6/FdBqOJ0kAiBCSABAhJAEgQkgCQISNO5/L/pJ5TN++fVP1zjvvHIxZsmRJVeZE9a1duzZVL1iwIBiz5557Br2LL744VZ9yyik1mU+SJMlnn31W8rhPPvmkKten+RQKhaDX1tYW9NatW9cR0+n0PEkCQISQBIAIIQkAEdYkP5f3/8nnyX7J/ogjjgjG/OpXv6rKnKi+7Hrf/fffH4zJW5McM2ZMqv7Xv/4VjJkyZcqGTW497LHHHh12LbqWYrFY7yk0FE+SABAhJAEgQkgCQISQBIAIG3c20OTJk4Peww8/nKqXLl3aUdNhPU2fPj3oHXDAAUFv2LBhqTrvf/chQ4ak6qOPPjoYs3LlylSd9zWP7bbbLn+y/8/TTz9dcgyw4TxJAkCEkASACCEJABFCEgAibNzZQH369Al6G2+8cR1mQiVaW1uD3sSJE4Pe9ddfn6qzG3mSJNy48/bbbwdjHn/88VS9ww47BGN69+6dP9n/Z9myZSXHABvOkyQARAhJAIgQkgAQ0bRrktk1nRtuuCEYM378+JLnyTvOelFje+2114LeiBEjUvU555wTjLniiitSdc+ePYMxRx11VMnrZ184kCRJcu2116bqBx54oOR5IEmS5L777kvV2S8ZJUmSzJ8/v6Om03A8SQJAhJAEgAghCQARQhIAIgrFYjH+w0Ih/kO6vGKxWKjHdRvhvisUwv9qdt9991Q9adKkYMzee++dqvNeOHDPPfeU1euq6nHfNcI9R+20d895kgSACCEJABFCEgAirEkSZU2SerAmSUezJgkAFRCSABAhJAEgQkgCQISQBIAIIQkAEUISACKEJABECEkAiBCSABAhJAEgQkgCQISQBICIdr8CAgDNzJMkAEQISQCIEJIAECEkASBCSAJAhJAEgIj/AeNeVINOrPGYAAAAAElFTkSuQmCC"/>


```python
batch_size = 64
z_dim = 100
epochs = 50
```


```python
dataloader = torch.utils.data.DataLoader(dataset=mnist_train,
                                          batch_size=batch_size,
                                          shuffle=True)
```

## 모델 생성



```python
class Generator(nn.Module):
  def __init__(self, z_dim):
    super(Generator, self).__init__()
    self.z_dim = z_dim
    self.gen = nn.Sequential(
        nn.ConvTranspose2d(z_dim, 128, 7, 1, 0),
        nn.BatchNorm2d(128),
        nn.LeakyReLU(0.2),
        nn.ConvTranspose2d(128, 64, 4, 2, padding=1),
        nn.BatchNorm2d(64),
        nn.LeakyReLU(0.2),
        nn.ConvTranspose2d(64, 1, 4, 2, padding=1),
        nn.Tanh()
    )

  def forward(self, x):
    return self.gen(x)
```


```python
class Discriminator(nn.Module):
  def __init__(self):
    super(Discriminator, self).__init__()
    self.disc = nn.Sequential(
        nn.Conv2d(1, 64, 4, stride=2, padding=1),
        nn.BatchNorm2d(64),
        nn.LeakyReLU(0.2),
        nn.Conv2d(64, 128, 4, stride=2, padding=1),
        nn.BatchNorm2d(128),
        nn.LeakyReLU(0.2),
        nn.Conv2d(128, 1, 7, stride=2, padding=0),
        nn.Sigmoid()
    )

  def forward(self, x):
    return self.disc(x)
```


```python
generator = Generator(z_dim).to(device)
discriminator = Discriminator().to(device)
```


```python
noise = torch.randn(1, z_dim, 1, 1).to(device)
sample = generator(noise)
img = sample.view(-1, 28, 28)
plt.imshow(img.squeeze().cpu().detach())
```

<pre>
<matplotlib.image.AxesImage at 0x7f6eaaef6d50>
</pre>
<img src="data:image/png;base64,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"/>


```python
discriminator(sample)
```

<pre>
tensor([[[[0.7300]]]], device='cuda:0', grad_fn=<SigmoidBackward0>)
</pre>

```python
fix_noise = torch.randn(8, z_dim, 1, 1).to(device)

loss_fn = nn.BCELoss()
g_opt = torch.optim.Adam(generator.parameters(), lr=0.0002)
d_opt = torch.optim.Adam(discriminator.parameters(), lr=0.0002)
```


```python
def generate_images(gen):
  imgs = generator(fix_noise)
  for i in range(len(imgs)):
    plt.subplot(1, len(imgs), i+1)
    plt.imshow(imgs[i].view(28,28).cpu().detach(), cmap="gray")
  plt.show()

for i in tqdm(range(epochs)):
  for _, (img, label) in enumerate(dataloader):
    real = img.to(device)
    noise = torch.randn(batch_size, z_dim, 1, 1).to(device)
    fake = generator(noise)

    real_output = discriminator(real)
    fake_output = discriminator(fake)

    real_loss = loss_fn(real_output, torch.ones_like(real_output))
    fake_loss = loss_fn(fake_output, torch.zeros_like(fake_output))
    d_loss = (real_loss + fake_loss) / 2
    d_opt.zero_grad()
    d_loss.backward(retain_graph=True)
    d_opt.step()

    output = discriminator(fake)
    g_loss = loss_fn(output, torch.ones_like(output))
    g_opt.zero_grad()
    g_loss.backward()
    g_opt.step()
  
  generate_images(generator)
```

<pre>
  0%|          | 0/50 [00:00<?, ?it/s]
</pre>

```python
generate_images(generator)
```

<img src="data:image/png;base64,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"/>


```python

```
